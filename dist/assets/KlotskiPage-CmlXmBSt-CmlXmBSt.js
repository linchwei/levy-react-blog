import{j as e,m as f,A as k}from"./ui-8Or-2zOT-8Or-2zOT.js";import{r as g}from"./vendor-QyoG3HE1-QyoG3HE1.js";import{C,b as B,f as T,a as S,B as j}from"./index-CB-nuzdG-CB-nuzdG.js";import{B as L}from"./badge-BFIphGmu-BFIphGmu.js";import{T as E}from"./trophy-BpnV6Nd4-BpnV6Nd4.js";import{C as D}from"./clock-4rjZRXqQ-4rjZRXqQ.js";import{M as I}from"./move-DXgPZwjI-DXgPZwjI.js";import{L as P}from"./lightbulb-Chg089RR-Chg089RR.js";import{R as $}from"./rotate-ccw-BgUc6dP3-BgUc6dP3.js";import{N as G}from"./Navigation-CVIh0ny8-CVIh0ny8.js";import{F as A}from"./Footer-HVOx1zD2-HVOx1zD2.js";import{G as H}from"./gamepad-2-Bui3mMO4-Bui3mMO4.js";import{B as R}from"./brain-C_k0nmbA-C_k0nmbA.js";import{T as O}from"./target-BaO0FYrG-BaO0FYrG.js";import"./animation-Cg-7L8ts-Cg-7L8ts.js";import"./input-BH5s_kIV-BH5s_kIV.js";import"./middleware-BIVXqGDk-BIVXqGDk.js";function V(s){const t=[];let a=1;for(let r=0;r<s;r++){t[r]=[];for(let n=0;n<s;n++)t[r][n]=a,a++}return t[s-1][s-1]=0,t}function N(s=4){const t=V(s);return{board:Y(t,s),size:s,moves:0,time:0,status:"IDLE",bestTime:parseInt(localStorage.getItem(`klotskiBestTime_${s}`)||"0"),bestMoves:parseInt(localStorage.getItem(`klotskiBestMoves_${s}`)||"0")}}function Y(s,t){const a=s.map(i=>[...i]);let r=0;const n=t*25;for(;r<n;){const i=b(a,t),l=v(i.row,i.col,t),c=l[Math.floor(Math.random()*l.length)];a[i.row][i.col]=a[c.row][c.col],a[c.row][c.col]=0,r++}return a}function b(s,t){for(let a=0;a<t;a++)for(let r=0;r<t;r++)if(s[a][r]===0)return{row:a,col:r};return{row:t-1,col:t-1}}function v(s,t,a){const r=[],n=[[-1,0],[1,0],[0,-1],[0,1]];for(const[i,l]of n){const c=s+i,d=t+l;c>=0&&c<a&&d>=0&&d<a&&r.push({row:c,col:d})}return r}function y(s,t,a,r){const n=b(s,t),i=Math.abs(a-n.row),l=Math.abs(r-n.col);return i===1&&l===0||i===0&&l===1}function _(s,t,a){if(s.status!=="PLAYING"&&s.status!=="IDLE"||!y(s.board,s.size,t,a))return s;const r=s.board.map(u=>[...u]),n=b(r,s.size);r[n.row][n.col]=r[t][a],r[t][a]=0;const i=s.moves+1,l=F(r,s.size);let c=s.bestTime,d=s.bestMoves;return l&&((s.bestTime===0||s.time<s.bestTime)&&(c=s.time,localStorage.setItem(`klotskiBestTime_${s.size}`,c.toString())),(s.bestMoves===0||i<s.bestMoves)&&(d=i,localStorage.setItem(`klotskiBestMoves_${s.size}`,d.toString()))),{...s,board:r,moves:i,status:l?"SOLVED":"PLAYING",bestTime:c,bestMoves:d}}function F(s,t){let a=1;for(let r=0;r<t;r++)for(let n=0;n<t;n++){if(r===t-1&&n===t-1)return s[r][n]===0;if(s[r][n]!==a)return!1;a++}return!0}function K(s){return N(s.size)}function q(s){return N(s)}function J(s,t){return s.status!=="PLAYING"?s:{...s,time:t}}function Q(s,t){const a=b(s,t),r=v(a.row,a.col,t);let n=null,i=1/0;for(const l of r){const c=s[l.row][l.col];if(c===0)continue;const d=Math.floor((c-1)/t),u=(c-1)%t,p=Math.abs(l.row-d)+Math.abs(l.col-u);p<i&&(i=p,n=l)}return n}function U({onSolve:s}){const[t,a]=g.useState(()=>N(4)),[r,n]=g.useState(null);g.useEffect(()=>{if(t.status!=="PLAYING")return;const o=setInterval(()=>{a(m=>J(m,m.time+1))},1e3);return()=>clearInterval(o)},[t.status]),g.useEffect(()=>{t.status==="SOLVED"&&(s==null||s(t.moves,t.time))},[t.status,t.moves,t.time,s]);const i=(o,m)=>{t.status!=="SOLVED"&&(a(x=>_(x,o,m)),n(null))},l=()=>{a(o=>K(o)),n(null)},c=o=>{a(q(o)),n(null)},d=()=>{const o=Q(t.board,t.size);n(o),setTimeout(()=>n(null),3e3)},u=o=>{const m=Math.floor(o/60),x=o%60;return`${m.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`},p=(o,m)=>{const h=t.board[o][m]===0,w=(r==null?void 0:r.row)===o&&(r==null?void 0:r.col)===m,M=y(t.board,t.size,o,m);return h?"bg-muted/50":w?"bg-yellow-500 text-white shadow-lg ring-2 ring-yellow-300":M?"bg-primary text-primary-foreground hover:bg-primary/90 cursor-pointer":"bg-secondary text-secondary-foreground"};return e.jsxs(C,{className:"w-full max-w-md mx-auto",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ğŸ§©"}),"æ•°å­—åå®¹é“"]}),e.jsx("div",{className:"flex items-center gap-2",children:t.bestMoves>0&&e.jsxs(L,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"}),t.bestMoves,"æ­¥"]})})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-center gap-1",children:[e.jsx(D,{className:"w-4 h-4"}),"æ—¶é—´"]}),e.jsx("p",{className:"text-xl font-bold font-mono",children:u(t.time)})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center justify-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),"æ­¥æ•°"]}),e.jsx("p",{className:"text-xl font-bold",children:t.moves})]})]}),e.jsx("div",{className:"flex justify-center gap-2",children:[3,4,5].map(o=>e.jsxs(j,{variant:t.size===o?"default":"outline",size:"sm",onClick:()=>c(o),disabled:t.status==="PLAYING",children:[o,"x",o]},o))}),e.jsx("div",{className:"flex justify-center",children:e.jsx(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"inline-block p-2 bg-muted rounded-lg",children:e.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${t.size}, minmax(0, 1fr))`},children:t.board.map((o,m)=>o.map((x,h)=>e.jsx(f.div,{initial:x!==0?{scale:0}:!1,animate:{scale:1},transition:{duration:.15},onClick:()=>i(m,h),className:`
                      w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center
                      text-xl sm:text-2xl font-bold rounded-md
                      transition-all duration-200
                      ${p(m,h)}
                      ${x!==0?"shadow-sm":""}
                    `,children:x!==0&&x},`${m}-${h}`)))})})}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsxs(j,{variant:"outline",onClick:d,disabled:t.status==="SOLVED",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"æç¤º"]}),e.jsxs(j,{variant:"outline",onClick:l,children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"é‡æ–°å¼€å§‹"]})]}),e.jsx(k,{children:t.status==="SOLVED"&&e.jsxs(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-center p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:"ğŸ‰ æ­å–œå®Œæˆï¼"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["ç”¨æ—¶ ",u(t.time),"ï¼Œ",t.moves," æ­¥"]}),(t.bestTime===t.time||t.bestMoves===t.moves)&&e.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"ğŸ† æ–°çºªå½•ï¼"})]})}),e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:[e.jsx("p",{children:"ç‚¹å‡»æ•°å­—ç§»åŠ¨ï¼Œå°†æ•°å­—æŒ‰é¡ºåºæ’åˆ—"}),e.jsx("p",{className:"mt-1",children:"ç©ºæ ¼åœ¨å³ä¸‹è§’æ—¶å®Œæˆ"})]})]})]})}function ue(){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(G,{}),e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"flex-1 pt-16",children:[e.jsxs("section",{className:"relative py-12 px-4 sm:px-6 lg:px-8 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute -top-1/2 -right-1/2 w-full h-full bg-gradient-to-b from-emerald-500/5 to-transparent rounded-full blur-3xl"})}),e.jsxs("div",{className:"relative max-w-7xl mx-auto text-center",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-emerald-500/10 mb-6",children:e.jsx(H,{className:"w-8 h-8 text-emerald-500"})}),e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold tracking-tight mb-4",children:e.jsx("span",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 bg-clip-text text-transparent",children:"æ•°å­—åå®¹é“"})}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"ç»å…¸ç›Šæ™ºæ¸¸æˆï¼Œå°†æ‰“ä¹±çš„æ•°å­—æŒ‰é¡ºåºæ’åˆ—ã€‚è€ƒéªŒä½ çš„é€»è¾‘æ€ç»´å’Œç©ºé—´æƒ³è±¡åŠ›ï¼"})]}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"mt-8 flex justify-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{children:"é€»è¾‘æ¨ç†"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{children:"ä¸‰ç§éš¾åº¦"})]})]})]})]}),e.jsx("section",{className:"py-8 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(U,{})})}),e.jsx("section",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-muted/30",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-8",children:"æ¸¸æˆæŠ€å·§"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ğŸ¯"}),e.jsx("h3",{className:"font-semibold mb-2",children:"é€è¡Œæ’åˆ—"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"å…ˆå®Œæˆç¬¬ä¸€è¡Œï¼Œç„¶åæ˜¯ç¬¬äºŒè¡Œï¼Œä¾æ­¤ç±»æ¨"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ğŸ§©"}),e.jsx("h3",{className:"font-semibold mb-2",children:"åˆ©ç”¨ç©ºæ ¼"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ç©ºæ ¼æ˜¯ç§»åŠ¨çš„å…³é”®ï¼Œåˆç†è§„åˆ’ç§»åŠ¨è·¯å¾„"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"âš¡"}),e.jsx("h3",{className:"font-semibold mb-2",children:"ç»ƒä¹ æ¨¡å¼"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ä»3x3å¼€å§‹ç»ƒä¹ ï¼Œé€æ­¥æŒ‘æˆ˜æ›´é«˜éš¾åº¦"})]})]})]})})]}),e.jsx(A,{})]})}export{ue as KlotskiPage};
//# sourceMappingURL=KlotskiPage-CmlXmBSt-CmlXmBSt.js.map
