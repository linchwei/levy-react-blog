import{j as e,m as u,A as R}from"./ui-DYkYaoix.js";import{r as g}from"./vendor-QyoG3HE1.js";import{C as G,b as I,h as O,a as P,B as f}from"./index-DeSSmPMO.js";import{B as T}from"./badge-BB4iipK0.js";import{T as A}from"./trophy-HywIcslr.js";import{R as w}from"./rotate-ccw-dbeTAKAN.js";import{P as D}from"./play-CTEUZwdb.js";import{C as B}from"./chevron-up-BXBXlJXI.js";import{C as W}from"./chevron-left-KkFRLFwM.js";import{C as M,N as Y}from"./Navigation-DSaOLIRN.js";import{C as V}from"./chevron-right-B0_HObaT.js";import{F as z}from"./Footer-CIleRj_M.js";import{G as J}from"./gamepad-2-DeiXWaNR.js";import{T as _}from"./target-BDzvMoBS.js";import"./animation-BjUy5Qx7.js";import"./input-DjkIl-os.js";import"./middleware-DopGOoqf.js";const h={boardSize:4,winValue:2048},F={2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#edc850",1024:"#edc53f",2048:"#edc22e",4096:"#3c3a32",8192:"#3c3a32"},U={2:"#776e65",4:"#776e65",8:"#f9f6f2",16:"#f9f6f2",32:"#f9f6f2",64:"#f9f6f2",128:"#f9f6f2",256:"#f9f6f2",512:"#f9f6f2",1024:"#f9f6f2",2048:"#f9f6f2",4096:"#f9f6f2",8192:"#f9f6f2"};function L(s=h.boardSize){return Array(s).fill(null).map(()=>Array(s).fill(null))}function j(s=h){let t=L(s.boardSize);return t=p(t),t=p(t),{board:t,score:0,bestScore:parseInt(localStorage.getItem("game2048BestScore")||"0"),status:"IDLE",hasWon:!1}}function k(s){const t=[];return s.forEach((n,r)=>{n.forEach((i,a)=>{i===null&&t.push({x:a,y:r})})}),t}function p(s){const t=k(s);if(t.length===0)return s;const{x:n,y:r}=t[Math.floor(Math.random()*t.length)],i=s.map(a=>[...a]);return i[r][n]=Math.random()<.9?2:4,i}function N(s){let t=s.filter(r=>r!==null),n=0;for(let r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,n+=t[r],t[r+1]=0);for(t=t.filter(r=>r!==0);t.length<s.length;)t.push(null);return{row:t,score:n}}function y(s){const t=[...s].reverse(),{row:n,score:r}=N(t);return{row:n.reverse(),score:r}}function v(s,t){return s.map(n=>n[t])}function C(s,t,n){return s.map((r,i)=>{const a=[...r];return a[t]=n[i],a})}function H(s,t){let n=L(s.length),r=0,i=!1;if(t==="LEFT")for(let a=0;a<s.length;a++){const{row:l,score:c}=N(s[a]);n[a]=l,r+=c,JSON.stringify(l)!==JSON.stringify(s[a])&&(i=!0)}else if(t==="RIGHT")for(let a=0;a<s.length;a++){const{row:l,score:c}=y(s[a]);n[a]=l,r+=c,JSON.stringify(l)!==JSON.stringify(s[a])&&(i=!0)}else if(t==="UP")for(let a=0;a<s[0].length;a++){const l=v(s,a),{row:c,score:m}=N(l);n=C(n,a,c),r+=m,JSON.stringify(c)!==JSON.stringify(l)&&(i=!0)}else if(t==="DOWN")for(let a=0;a<s[0].length;a++){const l=v(s,a),{row:c,score:m}=y(l);n=C(n,a,c),r+=m,JSON.stringify(c)!==JSON.stringify(l)&&(i=!0)}return{newBoard:n,score:r,moved:i}}function $(s){if(k(s).length>0)return!0;for(let t=0;t<s.length;t++)for(let n=0;n<s[t].length;n++){const r=s[t][n];if(r!==null&&(n<s[t].length-1&&s[t][n+1]===r||t<s.length-1&&s[t+1][n]===r))return!0}return!1}function K(s,t=h.winValue){return s.some(n=>n.some(r=>r===t))}function X(s,t,n=h){if(s.status!=="PLAYING"&&s.status!=="IDLE")return s;const{newBoard:r,score:i,moved:a}=H(s.board,t);if(!a)return s;const l=p(r),c=s.score+i,m=Math.max(c,s.bestScore);return!s.hasWon&&K(l,n.winValue)?(localStorage.setItem("game2048BestScore",m.toString()),{...s,board:l,score:c,bestScore:m,status:"WON",hasWon:!0}):$(l)?{...s,board:l,score:c,bestScore:m,status:"PLAYING"}:(localStorage.setItem("game2048BestScore",m.toString()),{...s,board:l,score:c,bestScore:m,status:"GAME_OVER"})}function q(s){return s.status==="PLAYING"?s:s.status==="GAME_OVER"||s.status==="WON"?{...j(),status:"PLAYING",bestScore:s.bestScore}:{...s,status:"PLAYING"}}function S(s){return{...j(),bestScore:s.bestScore}}function Q(s){return s.status!=="WON"?s:{...s,status:"PLAYING"}}function Z({onScoreChange:s,onGameOver:t,onWin:n}){const[r,i]=g.useState(()=>j()),a=g.useCallback(o=>{i(x=>{const d=X(x,o);return d.score!==x.score&&(s==null||s(d.score)),d.status==="GAME_OVER"&&x.status!=="GAME_OVER"&&(t==null||t(d.score)),d.status==="WON"&&x.status!=="WON"&&(n==null||n(d.score)),d})},[s,t,n]);g.useEffect(()=>{const o=x=>{switch(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(x.key)&&x.preventDefault(),x.key){case"ArrowUp":case"w":case"W":a("UP");break;case"ArrowDown":case"s":case"S":a("DOWN");break;case"ArrowLeft":case"a":case"A":a("LEFT");break;case"ArrowRight":case"d":case"D":a("RIGHT");break;case"r":case"R":i(d=>S(d));break}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[a]);const l=()=>{i(o=>q(o))},c=()=>{i(o=>S(o))},m=()=>{i(o=>Q(o))},b=o=>o===null?{backgroundColor:"rgba(238, 228, 218, 0.35)",color:"transparent"}:{backgroundColor:F[o]||"#3c3a32",color:U[o]||"#f9f6f2"};return e.jsxs(G,{className:"w-full max-w-lg mx-auto",children:[e.jsxs(I,{className:"flex flex-row items-center justify-between",children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ğŸ”¢"}),"2048"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(T,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),"æœ€ä½³: ",r.bestScore]})})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center gap-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"å½“å‰åˆ†æ•°"}),e.jsx("p",{className:"text-3xl font-bold",children:r.score})]})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsxs(u.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},className:"relative bg-[#bbada0] p-2 rounded-lg",children:[e.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.board.map((o,x)=>o.map((d,E)=>e.jsx(u.div,{initial:d!==null?{scale:0}:!1,animate:{scale:1},transition:{duration:.15,delay:.05},className:"w-16 h-16 sm:w-20 sm:h-20 rounded-lg flex items-center justify-center text-2xl sm:text-3xl font-bold transition-all duration-150",style:b(d),children:d!==null&&e.jsx(u.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},children:d})},`${x}-${E}`)))}),e.jsx(R,{children:r.status!=="PLAYING"&&r.status!=="IDLE"&&e.jsxs(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 flex flex-col items-center justify-center bg-background/90 rounded-lg m-2",children:[r.status==="WON"&&e.jsxs(e.Fragment,{children:[e.jsx(u.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"text-4xl mb-2",children:"ğŸ‰"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-500 mb-2",children:"ä½ èµ¢äº†ï¼"}),e.jsxs("p",{className:"text-lg mb-4",children:["å¾—åˆ†: ",r.score]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{onClick:m,variant:"outline",children:"ç»§ç»­æŒ‘æˆ˜"}),e.jsx(f,{onClick:l,children:"æ–°æ¸¸æˆ"})]})]}),r.status==="GAME_OVER"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-destructive mb-2",children:"æ¸¸æˆç»“æŸ"}),e.jsxs("p",{className:"text-lg mb-4",children:["æœ€ç»ˆå¾—åˆ†: ",r.score]}),e.jsxs(f,{onClick:l,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"å†æ¥ä¸€å±€"]})]})]})})]})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[r.status==="IDLE"&&e.jsxs(f,{onClick:l,size:"lg",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"å¼€å§‹æ¸¸æˆ"]}),e.jsxs(f,{variant:"outline",onClick:c,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"æ–°æ¸¸æˆ"]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 md:hidden",children:[e.jsx(f,{variant:"outline",size:"icon",onClick:()=>a("UP"),disabled:r.status!=="PLAYING",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(f,{variant:"outline",size:"icon",onClick:()=>a("LEFT"),disabled:r.status!=="PLAYING",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx(f,{variant:"outline",size:"icon",onClick:()=>a("DOWN"),disabled:r.status!=="PLAYING",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx(f,{variant:"outline",size:"icon",onClick:()=>a("RIGHT"),disabled:r.status!=="PLAYING",children:e.jsx(V,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:[e.jsx("p",{children:"æ“ä½œ: â†‘â†“â†â†’ æˆ– WASD æ»‘åŠ¨ | R æ–°æ¸¸æˆ"}),e.jsx("p",{className:"mt-1",children:"ç›®æ ‡: åˆå¹¶æ•°å­—å¾—åˆ° 2048"})]})]})]})}function pe(){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(Y,{}),e.jsxs(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"flex-1 pt-16",children:[e.jsxs("section",{className:"relative py-12 px-4 sm:px-6 lg:px-8 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute -top-1/2 -right-1/2 w-full h-full bg-gradient-to-b from-orange-500/5 to-transparent rounded-full blur-3xl"})}),e.jsxs("div",{className:"relative max-w-7xl mx-auto text-center",children:[e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-orange-500/10 mb-6",children:e.jsx(J,{className:"w-8 h-8 text-orange-500"})}),e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold tracking-tight mb-4",children:e.jsx("span",{className:"bg-gradient-to-r from-orange-500 to-amber-500 bg-clip-text text-transparent",children:"2048"})}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"æ»‘åŠ¨æ•°å­—æ–¹å—ï¼Œåˆå¹¶ç›¸åŒæ•°å­—ï¼ŒæŒ‘æˆ˜è¾¾åˆ° 2048ï¼"})]}),e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"mt-8 flex justify-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsx("span",{children:"ç›®æ ‡ï¼šè¾¾åˆ° 2048"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"è®°å½•ä¿å­˜åœ¨æœ¬åœ°"})]})]})]})]}),e.jsx("section",{className:"py-8 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Z,{})})}),e.jsx("section",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-muted/30",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-8",children:"æ¸¸æˆæŠ€å·§"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ğŸ¯"}),e.jsx("h3",{className:"font-semibold mb-2",children:"è§’è½ç­–ç•¥"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"å°†æœ€å¤§çš„æ•°å­—ä¿æŒåœ¨è§’è½ï¼Œå›´ç»•å®ƒæ„å»ºæ•°å­—é“¾"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ğŸ“Š"}),e.jsx("h3",{className:"font-semibold mb-2",children:"ä¿æŒæœ‰åº"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"å°½é‡ä¿æŒæ•°å­—æŒ‰å¤§å°é¡ºåºæ’åˆ—ï¼Œä¾¿äºåˆå¹¶"})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[e.jsx("div",{className:"text-3xl mb-3",children:"ğŸ”„"}),e.jsx("h3",{className:"font-semibold mb-2",children:"é¢„ç•™ç©ºé—´"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"å§‹ç»ˆä¿æŒä¸€äº›ç©ºå•å…ƒæ ¼ï¼Œç»™è‡ªå·±æ“ä½œçš„ç©ºé—´"})]})]})]})})]}),e.jsx(z,{})]})}export{pe as Game2048Page};
//# sourceMappingURL=Game2048Page-_1r9KG-V.js.map
