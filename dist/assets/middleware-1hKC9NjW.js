import{b as S}from"./vendor-QyoG3HE1.js";import{c as O}from"./animation-DpLQP9uM.js";const C=n=>n;function E(n,i=C){const r=S.useSyncExternalStore(n.subscribe,S.useCallback(()=>i(n.getState()),[n,i]),S.useCallback(()=>i(n.getInitialState()),[n,i]));return S.useDebugValue(r),r}const w=n=>{const i=O(n),r=o=>E(i,o);return Object.assign(r,i),r},j=(n=>n?w(n):w);function F(n,i){let r;try{r=n()}catch{return}return{getItem:a=>{var e;const m=d=>d===null?null:JSON.parse(d,void 0),c=(e=r.getItem(a))!=null?e:null;return c instanceof Promise?c.then(m):m(c)},setItem:(a,e)=>r.setItem(a,JSON.stringify(e,void 0)),removeItem:a=>r.removeItem(a)}}const _=n=>i=>{try{const r=n(i);return r instanceof Promise?r:{then(o){return _(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return _(o)(r)}}}},J=(n,i)=>(r,o,a)=>{let e={storage:F(()=>window.localStorage),partialize:t=>t,version:0,merge:(t,h)=>({...h,...t}),...i},m=!1,c=0;const d=new Set,y=new Set;let l=e.storage;if(!l)return n((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),r(...t)},o,a);const p=()=>{const t=e.partialize({...o()});return l.setItem(e.name,{state:t,version:e.version})},R=a.setState;a.setState=(t,h)=>(R(t,h),p());const v=n((...t)=>(r(...t),p()),o,a);a.getInitialState=()=>v;let f;const H=()=>{var t,h;if(!l)return;const I=++c;m=!1,d.forEach(s=>{var u;return s((u=o())!=null?u:v)});const g=((h=e.onRehydrateStorage)==null?void 0:h.call(e,(t=o())!=null?t:v))||void 0;return _(l.getItem.bind(l))(e.name).then(s=>{if(s)if(typeof s.version=="number"&&s.version!==e.version){if(e.migrate){const u=e.migrate(s.state,s.version);return u instanceof Promise?u.then(b=>[!0,b]):[!0,u]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,s.state];return[!1,void 0]}).then(s=>{var u;if(I!==c)return;const[b,k]=s;if(f=e.merge(k,(u=o())!=null?u:v),r(f,!0),b)return p()}).then(()=>{I===c&&(g==null||g(f,void 0),f=o(),m=!0,y.forEach(s=>s(f)))}).catch(s=>{I===c&&(g==null||g(void 0,s))})};return a.persist={setOptions:t=>{e={...e,...t},t.storage&&(l=t.storage)},clearStorage:()=>{l==null||l.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>H(),hasHydrated:()=>m,onHydrate:t=>(d.add(t),()=>{d.delete(t)}),onFinishHydration:t=>(y.add(t),()=>{y.delete(t)})},e.skipHydration||H(),f||v},x=J;export{j as c,x as p};
//# sourceMappingURL=middleware-1hKC9NjW.js.map
