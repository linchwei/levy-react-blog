import{j as r,m as P}from"./ui-DYkYaoix.js";import{r as g}from"./vendor-QyoG3HE1.js";import{C as X,b as J,h as Z,a as K,B as h}from"./index-DeSSmPMO.js";import{B as q}from"./badge-BB4iipK0.js";import{T as M}from"./trophy-HywIcslr.js";import{P as E}from"./play-CTEUZwdb.js";import{R}from"./rotate-ccw-dbeTAKAN.js";import{P as Q}from"./pause-Ha661Iio.js";import{R as $}from"./rotate-cw-DqsoV3yq.js";import{C as G,N as ee}from"./Navigation-DSaOLIRN.js";import{C as re}from"./chevron-left-KkFRLFwM.js";import{C as se}from"./chevron-right-B0_HObaT.js";import{F as te}from"./Footer-CIleRj_M.js";import{G as ne}from"./gamepad-2-DeiXWaNR.js";import{T as le}from"./target-BDzvMoBS.js";import"./animation-BjUy5Qx7.js";import"./input-DjkIl-os.js";import"./middleware-DopGOoqf.js";const j={boardWidth:10,boardHeight:20,initialSpeed:1e3,speedIncrement:50,minSpeed:100},z={I:{shape:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],color:"#06b6d4"},O:{shape:[[1,1],[1,1]],color:"#eab308"},T:{shape:[[0,1,0],[1,1,1],[0,0,0]],color:"#a855f7"},S:{shape:[[0,1,1],[1,1,0],[0,0,0]],color:"#22c55e"},Z:{shape:[[1,1,0],[0,1,1],[0,0,0]],color:"#ef4444"},J:{shape:[[1,0,0],[1,1,1],[0,0,0]],color:"#3b82f6"},L:{shape:[[0,0,1],[1,1,1],[0,0,0]],color:"#f97316"}};function I(){const e=["I","O","T","S","Z","J","L"];return e[Math.floor(Math.random()*e.length)]}function H(e,t,i){const c=z[e];return{type:e,shape:c.shape,x:t??Math.floor((j.boardWidth-c.shape[0].length)/2),y:i??0,color:c.color}}function ce(e=j.boardWidth,t=j.boardHeight){return Array(t).fill(null).map(()=>Array(e).fill(null).map(()=>({filled:!1})))}function C(e=j){const t=I(),i=I();return{board:ce(e.boardWidth,e.boardHeight),currentPiece:H(t),nextPiece:i,score:0,level:1,lines:0,status:"IDLE",highScore:parseInt(localStorage.getItem("tetrisHighScore")||"0")}}function ae(e){const t=e.length,i=e[0].length,c=Array(i).fill(null).map(()=>Array(t).fill(0));for(let s=0;s<t;s++)for(let a=0;a<i;a++)c[a][t-1-s]=e[s][a];return c}function y(e,t,i,c,s){const a=i??e.x,u=c??e.y,d=s??e.shape;for(let x=0;x<d.length;x++)for(let m=0;m<d[x].length;m++)if(d[x][m]){const w=a+m,v=u+x;if(w<0||w>=t[0].length||v>=t.length||v>=0&&t[v][w].filled)return!1}return!0}function ie(e,t){const i=t.map(c=>[...c]);for(let c=0;c<e.shape.length;c++)for(let s=0;s<e.shape[c].length;s++)if(e.shape[c][s]){const a=e.y+c,u=e.x+s;a>=0&&(i[a][u]={filled:!0,color:e.color,type:e.type})}return i}function oe(e){const t=[];let i=0;for(let c=0;c<e.length;c++)e[c].every(s=>s.filled)?i++:t.push([...e[c]]);for(;t.length<e.length;)t.unshift(Array(e[0].length).fill(null).map(()=>({filled:!1})));return{newBoard:t,linesCleared:i}}function de(e,t){return([0,100,300,600,1e3][e]||0)*t}function ue(e,t=j){const i=t.initialSpeed-(e-1)*t.speedIncrement;return Math.max(i,t.minSpeed)}function N(e,t,i){if(e.status!=="PLAYING")return e;const c=e.currentPiece.x+t,s=e.currentPiece.y+i;return y(e.currentPiece,e.board,c,s)?{...e,currentPiece:{...e.currentPiece,x:c,y:s}}:i>0?W(e):e}function Y(e){if(e.status!=="PLAYING")return e;const t=ae(e.currentPiece.shape);if(y(e.currentPiece,e.board,void 0,void 0,t))return{...e,currentPiece:{...e.currentPiece,shape:t}};const i=[-1,1,-2,2];for(const c of i)if(y(e.currentPiece,e.board,e.currentPiece.x+c,void 0,t))return{...e,currentPiece:{...e.currentPiece,x:e.currentPiece.x+c,shape:t}};return e}function T(e){if(e.status!=="PLAYING")return e;let t=e.currentPiece.y;for(;y(e.currentPiece,e.board,e.currentPiece.x,t+1);)t++;return W({...e,currentPiece:{...e.currentPiece,y:t}})}function W(e){const t=ie(e.currentPiece,e.board),{newBoard:i,linesCleared:c}=oe(t),s=e.score+de(c,e.level),a=e.lines+c,u=Math.floor(a/10)+1,d=H(e.nextPiece),x=I();if(!y(d,i)){const m=Math.max(s,e.highScore);return localStorage.setItem("tetrisHighScore",m.toString()),{...e,board:i,score:s,lines:a,level:u,status:"GAME_OVER",highScore:m}}return{...e,board:i,currentPiece:d,nextPiece:x,score:s,lines:a,level:u}}function xe(e){return e.status!=="PLAYING"?e:N(e,0,1)}function me(e){return e.status==="PLAYING"?e:e.status==="GAME_OVER"?{...C(),status:"PLAYING",highScore:e.highScore}:{...e,status:"PLAYING"}}function he(e){return e.status!=="PLAYING"?e:{...e,status:"PAUSED"}}function fe(e){return e.status!=="PAUSED"?e:{...e,status:"PLAYING"}}function B(e){return{...C(),highScore:e.highScore}}function D(e){return e.status==="PLAYING"?he(e):e.status==="PAUSED"?fe(e):e}function pe({onScoreChange:e,onGameOver:t}){const i=g.useRef(null),c=g.useRef(null),[s,a]=g.useState(()=>C()),u=g.useRef(null),d=25,x=j.boardWidth*d,m=j.boardHeight*d,w=g.useCallback(()=>{const o=i.current;if(!o)return;const n=o.getContext("2d");if(n){n.fillStyle="#1a1a2e",n.fillRect(0,0,x,m),n.strokeStyle="#2d2d44",n.lineWidth=1;for(let l=0;l<=j.boardWidth;l++)n.beginPath(),n.moveTo(l*d,0),n.lineTo(l*d,m),n.stroke();for(let l=0;l<=j.boardHeight;l++)n.beginPath(),n.moveTo(0,l*d),n.lineTo(x,l*d),n.stroke();s.board.forEach((l,b)=>{l.forEach((p,f)=>{p.filled&&p.color&&(n.fillStyle=p.color,n.shadowColor=p.color,n.shadowBlur=5,n.fillRect(f*d+1,b*d+1,d-2,d-2),n.shadowBlur=0)})}),s.currentPiece.shape.forEach((l,b)=>{l.forEach((p,f)=>{if(p){const S=s.currentPiece.x+f,A=s.currentPiece.y+b;A>=0&&(n.fillStyle=s.currentPiece.color,n.shadowColor=s.currentPiece.color,n.shadowBlur=8,n.fillRect(S*d+1,A*d+1,d-2,d-2),n.shadowBlur=0)}})})}},[s,x,m]),v=g.useCallback(()=>{const o=c.current;if(!o)return;const n=o.getContext("2d");if(!n)return;n.fillStyle="#1a1a2e",n.fillRect(0,0,100,100);const l=z[s.nextPiece],b=l.shape,p=l.color,f=20,S=(100-b[0].length*f)/2,A=(100-b.length*f)/2;b.forEach((U,_)=>{U.forEach((F,O)=>{F&&(n.fillStyle=p,n.shadowColor=p,n.shadowBlur=5,n.fillRect(S+O*f,A+_*f,f-2,f-2),n.shadowBlur=0)})})},[s.nextPiece]);g.useEffect(()=>{if(s.status==="PLAYING"){const o=ue(s.level);u.current=setInterval(()=>{a(n=>{const l=xe(n);return l.status==="GAME_OVER"&&n.status!=="GAME_OVER"&&(t==null||t(l.score)),l.score!==n.score&&(e==null||e(l.score)),l})},o)}else u.current&&(clearInterval(u.current),u.current=null);return()=>{u.current&&clearInterval(u.current)}},[s.status,s.level,e,t]),g.useEffect(()=>{w(),v()},[w,v]),g.useEffect(()=>{const o=n=>{switch(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(n.key)&&n.preventDefault(),n.key){case"ArrowLeft":case"a":case"A":a(l=>N(l,-1,0));break;case"ArrowRight":case"d":case"D":a(l=>N(l,1,0));break;case"ArrowDown":case"s":case"S":a(l=>N(l,0,1));break;case"ArrowUp":case"w":case"W":a(l=>Y(l));break;case" ":a(l=>T(l));break;case"p":case"P":a(l=>D(l));break;case"r":case"R":a(l=>B(l));break}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[]);const k=()=>{a(o=>me(o))},V=()=>{a(o=>B(o))},L=()=>{a(o=>D(o))};return r.jsxs(X,{className:"w-full max-w-3xl mx-auto",children:[r.jsxs(J,{className:"flex flex-row items-center justify-between",children:[r.jsxs(Z,{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:"ğŸ§±"}),"ä¿„ç½—æ–¯æ–¹å—"]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs(q,{variant:"secondary",className:"flex items-center gap-1",children:[r.jsx(M,{className:"w-3 h-3"}),"æœ€é«˜åˆ†: ",s.highScore]})})]}),r.jsxs(K,{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"relative flex justify-center",children:r.jsxs(P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},className:"relative",children:[r.jsx("canvas",{ref:i,width:x,height:m,className:"border-2 border-border rounded-lg",style:{imageRendering:"pixelated"}}),s.status!=="PLAYING"&&r.jsxs(P.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 flex flex-col items-center justify-center bg-background/80 rounded-lg",children:[s.status==="IDLE"&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-lg font-medium mb-4",children:"å‡†å¤‡å¥½äº†å—ï¼Ÿ"}),r.jsxs(h,{onClick:k,size:"lg",children:[r.jsx(E,{className:"w-4 h-4 mr-2"}),"å¼€å§‹æ¸¸æˆ"]})]}),s.status==="PAUSED"&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-lg font-medium mb-4",children:"æ¸¸æˆæš‚åœ"}),r.jsxs(h,{onClick:L,size:"lg",children:[r.jsx(E,{className:"w-4 h-4 mr-2"}),"ç»§ç»­æ¸¸æˆ"]})]}),s.status==="GAME_OVER"&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-2xl font-bold text-destructive mb-2",children:"æ¸¸æˆç»“æŸ"}),r.jsxs("p",{className:"text-lg mb-4",children:["æœ€ç»ˆå¾—åˆ†: ",s.score]}),r.jsxs(h,{onClick:k,size:"lg",children:[r.jsx(R,{className:"w-4 h-4 mr-2"}),"å†æ¥ä¸€å±€"]})]})]})]})}),r.jsxs("div",{className:"flex flex-row md:flex-col gap-4 justify-center",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"ä¸‹ä¸€ä¸ª"}),r.jsx("canvas",{ref:c,width:100,height:100,className:"border-2 border-border rounded-lg"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"åˆ†æ•°"}),r.jsx("p",{className:"text-2xl font-bold",children:s.score})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"ç­‰çº§"}),r.jsx("p",{className:"text-2xl font-bold",children:s.level})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"è¡Œæ•°"}),r.jsx("p",{className:"text-2xl font-bold",children:s.lines})]})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[s.status==="PLAYING"?r.jsxs(h,{variant:"outline",onClick:L,children:[r.jsx(Q,{className:"w-4 h-4 mr-2"}),"æš‚åœ"]}):r.jsxs(h,{onClick:k,children:[r.jsx(E,{className:"w-4 h-4 mr-2"}),s.status==="GAME_OVER"?"å†æ¥ä¸€å±€":"å¼€å§‹"]}),r.jsxs(h,{variant:"outline",onClick:V,children:[r.jsx(R,{className:"w-4 h-4 mr-2"}),"é‡ç½®"]})]}),r.jsxs("div",{className:"flex flex-col items-center gap-2 md:hidden",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(h,{variant:"outline",size:"icon",onClick:()=>a(o=>Y(o)),disabled:s.status!=="PLAYING",children:r.jsx($,{className:"w-4 h-4"})}),r.jsx(h,{variant:"outline",size:"icon",onClick:()=>a(o=>T(o)),disabled:s.status!=="PLAYING",children:r.jsx(G,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(h,{variant:"outline",size:"icon",onClick:()=>a(o=>N(o,-1,0)),disabled:s.status!=="PLAYING",children:r.jsx(re,{className:"w-4 h-4"})}),r.jsx(h,{variant:"outline",size:"icon",onClick:()=>a(o=>N(o,0,1)),disabled:s.status!=="PLAYING",children:r.jsx(G,{className:"w-4 h-4"})}),r.jsx(h,{variant:"outline",size:"icon",onClick:()=>a(o=>N(o,1,0)),disabled:s.status!=="PLAYING",children:r.jsx(se,{className:"w-4 h-4"})})]})]}),r.jsx("div",{className:"text-sm text-muted-foreground text-center",children:r.jsx("p",{children:"æ“ä½œ: â†â†’ ç§»åŠ¨ | â†‘ æ—‹è½¬ | â†“ åŠ é€Ÿ | ç©ºæ ¼ ç¡¬é™ | P æš‚åœ | R é‡ç½®"})})]})]})}function Te(){return r.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[r.jsx(ee,{}),r.jsxs(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"flex-1 pt-16",children:[r.jsxs("section",{className:"relative py-12 px-4 sm:px-6 lg:px-8 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 overflow-hidden",children:r.jsx("div",{className:"absolute -top-1/2 -right-1/2 w-full h-full bg-gradient-to-b from-blue-500/5 to-transparent rounded-full blur-3xl"})}),r.jsxs("div",{className:"relative max-w-7xl mx-auto text-center",children:[r.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[r.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-500/10 mb-6",children:r.jsx(ne,{className:"w-8 h-8 text-blue-500"})}),r.jsx("h1",{className:"text-4xl sm:text-5xl font-bold tracking-tight mb-4",children:r.jsx("span",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 bg-clip-text text-transparent",children:"ä¿„ç½—æ–¯æ–¹å—"})}),r.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"ç»å…¸ç›Šæ™ºæ¸¸æˆï¼Œæ—‹è½¬å’Œç§»åŠ¨æ–¹å—ï¼Œå¡«æ»¡æ•´è¡Œæ¶ˆé™¤å¾—åˆ†ï¼"})]}),r.jsxs(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"mt-8 flex justify-center gap-8",children:[r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(le,{className:"w-5 h-5"}),r.jsx("span",{children:"ç›®æ ‡ï¼šæ¶ˆé™¤æ›´å¤šè¡Œ"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(M,{className:"w-5 h-5"}),r.jsx("span",{children:"è®°å½•ä¿å­˜åœ¨æœ¬åœ°"})]})]})]})]}),r.jsx("section",{className:"py-8 px-4 sm:px-6 lg:px-8",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsx(pe,{})})}),r.jsx("section",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-muted/30",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsx("h2",{className:"text-2xl font-bold text-center mb-8",children:"æ¸¸æˆæŠ€å·§"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[r.jsx("div",{className:"text-3xl mb-3",children:"ğŸ¯"}),r.jsx("h3",{className:"font-semibold mb-2",children:"ä¿æŒå¹³æ•´"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"å°½é‡ä¿æŒé¡¶éƒ¨å¹³æ•´ï¼Œé¿å…äº§ç”Ÿéš¾ä»¥å¡«è¡¥çš„ç©ºæ´"})]}),r.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[r.jsx("div",{className:"text-3xl mb-3",children:"âš¡"}),r.jsx("h3",{className:"font-semibold mb-2",children:"ä½¿ç”¨ç¡¬é™"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"æŒ‰ç©ºæ ¼é”®å¯ä»¥å¿«é€Ÿè½åˆ°åº•éƒ¨ï¼ŒèŠ‚çœæ—¶é—´"})]}),r.jsxs("div",{className:"p-6 rounded-xl bg-background border border-border/50",children:[r.jsx("div",{className:"text-3xl mb-3",children:"ğŸ§±"}),r.jsx("h3",{className:"font-semibold mb-2",children:"é¢„ç•™ I å—"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"é•¿æ¡å—å¯ä»¥æ¶ˆé™¤å››è¡Œï¼Œé¢„ç•™ä½ç½®ä»¥å¤‡ä¸æ—¶ä¹‹éœ€"})]})]})]})})]}),r.jsx(te,{})]})}export{Te as TetrisPage};
//# sourceMappingURL=TetrisPage-1iVMuM2o.js.map
